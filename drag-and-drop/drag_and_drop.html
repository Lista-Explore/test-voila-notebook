<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag-and-Drop Activity</title>
    <style>
        /* Your CSS styles */
        #drag-container, #drop-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        .draggable, .dropzone {
            width: 100px;
            height: 60px;
            border: 2px solid #ccc;
            border-radius: 5px;
            text-align: center;
            line-height: 60px;
            font-weight: bold;
            user-select: none;
        }
        .draggable {
            background-color: #f0f0f0;
            cursor: grab;
        }
        .dropzone {
            background-color: #fafafa;
        }
        .dropzone.correct {
            background-color: #c8e6c9;
            border-color: #2e7d32;
        }
        .dropzone.incorrect {
            background-color: #ffcdd2;
            border-color: #c62828;
        }
    </style>
</head>
<body>
    <p>Drag each item into its corresponding space:</p>

    <div id="drag-container"></div>
    <div id="drop-container"></div>

    <script>
        // Fetch questions data
        (async function() {
            // URL should be passed into this HTML file
            const urlParams = new URLSearchParams(window.location.search);
            const questionsUrl = urlParams.get('questions_url');

            try {
                const response = await fetch(questionsUrl);
                const data = await response.json();

                // Generate draggable items
                const dragContainer = document.getElementById('drag-container');
                data.items.forEach(item => {
                    const draggable = document.createElement('div');
                    draggable.classList.add('draggable');
                    draggable.setAttribute('draggable', 'true');
                    draggable.id = item.id;
                    draggable.textContent = item.label;
                    dragContainer.appendChild(draggable);
                });

                // Generate drop zones
                const dropContainer = document.getElementById('drop-container');
                data.dropZones.forEach(zone => {
                    const dropzone = document.createElement('div');
                    dropzone.classList.add('dropzone');
                    dropzone.id = zone.id;
                    dropzone.textContent = zone.label;
                    dropContainer.appendChild(dropzone);
                });

                // Set up drag-and-drop functionality
                const draggables = document.querySelectorAll('.draggable');
                const dropzones = document.querySelectorAll('.dropzone');

                draggables.forEach(draggable => {
                    draggable.addEventListener('dragstart', e => {
                        e.dataTransfer.setData('text/plain', e.target.id);
                    });
                });

                dropzones.forEach(dropzone => {
                    dropzone.addEventListener('dragover', e => {
                        e.preventDefault(); // Allow dropping
                    });

                    dropzone.addEventListener('drop', e => {
                        e.preventDefault();
                        const draggableId = e.dataTransfer.getData('text/plain');
                        const draggableElement = document.getElementById(draggableId);

                        if (!dropzone.hasChildNodes()) {
                            dropzone.appendChild(draggableElement);
                        }

                        const correctDropZoneId = data.items.find(item => item.id === draggableId).correctDropZone;
                        if (dropzone.id === correctDropZoneId) {
                            dropzone.classList.add('correct');
                            dropzone.classList.remove('incorrect');
                        } else {
                            dropzone.classList.add('incorrect');
                            dropzone.classList.remove('correct');
                        }
                    });
                });
            } catch (error) {
                console.error('Error fetching or processing the questions file:', error);
            }
        })();
    </script>
</body>
</html>
